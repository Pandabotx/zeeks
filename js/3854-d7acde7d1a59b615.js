"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3854],{42626:function(e,t,n){n.d(t,{u:function(){return h}});var o=n(85893),r=n(57747),a=n(48783),l=n(67294),s=n(92262),i=n(24308),d=n(80515),c=n(66868),u=n(70612);n(60939),n(3601),n(8328);var m=n(21194),x=n(16313),p=n(36652),f=n(16312);let h=e=>{let{initialTokensData:t,...n}=e,[h,v]=(0,l.useState)(null);return!function(e){let t=(0,f.xxU)(),{onCurrencySelection:n}=(0,m._r)();(0,l.useEffect)(()=>{if(!e||!t)return;let o=(0,p.Dd)(e.from,t),r=(0,p.Dd)(e.to,t);o&&r&&(n(x.C.INPUT,o),n(x.C.OUTPUT,r))},[e,n,t])}(t),(0,o.jsx)(r.xu,{padding:"12px",bg:"gray.2",borderRadius:16,maxWidth:"573px",mx:"auto",w:"100%",...n,children:(0,o.jsxs)(a.g,{children:[(0,o.jsx)(u.O,{}),(0,o.jsx)(i.v,{}),(0,o.jsx)(c.L,{}),(0,o.jsx)(d.S,{}),(0,o.jsx)(s.J,{isOpen:!!h,status:null==h?void 0:h.status,title:null==h?void 0:h.title,message:null==h?void 0:h.message,txHash:null==h?void 0:h.txHash,onClose:()=>v(null)})]})})}},31240:function(e,t,n){n.d(t,{Z:function(){return o}});let o=new Intl.NumberFormat("en-us",{currency:"USD",style:"currency",minimumFractionDigits:0,maximumFractionDigits:2})},46418:function(e,t,n){n.d(t,{z:function(){return u}});var o=n(82729),r=n(36492),a=n(80108),l=n(88149),s=n(86774),i=n(16312);function d(){let e=(0,o._)(["\n    query {\n      bundles {\n        id\n        maticPriceUSD\n      }\n    }\n  "]);return d=function(){return e},e}let c=async e=>{var t;let n=(0,a.Ps)(d()),o=(0,s.iE)(e);if(!o)return null;let r=await (0,a.WY)("".concat(null==o?void 0:o.URLS.subgraphUrlV3),n);return null!==(t=r.bundles[0])&&void 0!==t?t:null};function u(){let e=(0,i.xxU)();return(0,r.a)([l.i.NATIVE_PRICE,e],()=>c(e),{staleTime:5e3,refetchOnWindowFocus:!1,enabled:!!e})}},65689:function(e,t,n){n.d(t,{f:function(){return u}});var o=n(82729),r=n(36492),a=n(80108),l=n(88149),s=n(16312),i=n(86774);function d(){let e=(0,o._)(['\n      query {\n        token(id: "','") {\n          id\n          symbol\n          name\n          decimals\n          derivedMatic\n        }\n      }\n    ']);return d=function(){return e},e}let c=async(e,t)=>{let n=(0,a.Ps)(d(),e.tokenId),o=(0,i.iE)(t),r=await (0,a.WY)("".concat(null==o?void 0:o.URLS.subgraphUrlV3),n,e);return r.token};function u(e){let t=(0,s.xxU)();return(0,r.a)([l.i.SINGLE_TOKEN,{params:e,chainId:t}],()=>c(e,t),{staleTime:5e3,refetchOnWindowFocus:!1,enabled:!!e.tokenId})}},18717:function(e,t,n){n.r(t),n.d(t,{SwapPage:function(){return ep},default:function(){return ef}});var o=n(85893),r=n(93717),a=n(27239),l=n(81136),s=n(57747),i=n(34292),d=n(14e3),c=n(67294),u=n(48783),m=n(16312),x=n(37084),p=n(61926),f=n(18192),h=n(85243),v=n(47658),g=n(94249),b=n(91203),j=n(61561),w=n(19752),T=n(39842),k=n(86774),y=n(99091);let C=e=>{var t,n,r,a,l;let{state:s,isSwapAvailable:i,swapInProgress:d,onSubmit:c,isFromValueEmpty:u,isBalanceExceeded:p}=e,{isReadOnly:f}=(0,w.F)(),h=(0,y.D)(),C=(0,m.SFn)(),S=!!C,E=(0,k.ZR)(),{requiresApproval:A,approve:N,isApproveInProgress:W,getAllowance:I}=(0,j.Z)(s.from),O=((null===(t=s.from.token)||void 0===t?void 0:t.contractAddress)==(null==E?void 0:E.CONTRACTS.WETH)||(null===(n=s.from.token)||void 0===n?void 0:n.contractAddress)===T.aW)&&((null===(r=s.to.token)||void 0===r?void 0:r.contractAddress)==(null==E?void 0:E.CONTRACTS.WETH)||(null===(a=s.to.token)||void 0===a?void 0:a.contractAddress)===T.aW);return f?null:S?h?null:!A||p||O?h?null:(0,o.jsx)(g.M,{disabled:!S||!i||p||u,isLoading:d,loadingText:"Processing...",onClick:c,label:p?"Insufficient balance":u?"Enter token amount to swap":"Proceed to swap"}):(0,o.jsx)(g.M,{isLoading:W,loadingText:"Processing...",onClick:async()=>{var e,t,n;try{let n=await N();if(!(n instanceof m.qwg)){await I();let r=null==n?void 0:null===(e=n.receipt)||void 0===e?void 0:e.transactionHash;(0,b.XA)("Successfully approved ".concat(null===(t=s.from.token)||void 0===t?void 0:t.symbol),(0,o.jsx)(x.d,{txHash:r}))}}catch(e){e instanceof m.qwg?(0,b.Eo)(e.reason):(0,b.Eo)("Error approving ".concat(null===(n=s.from.token)||void 0===n?void 0:n.symbol))}},label:"Approve ".concat(null===(l=s.from.token)||void 0===l?void 0:l.symbol)}):(0,o.jsx)(v.I,{})};var S=n(19197),E=n(36070),A=n(77640),N=n(6147),W=n(96854),I=n(89993),O=n(89211),U=n(79078),R=n(90512),H=n(41545),P=n(90251),L=n(3601),F=n(62639),Z=n.n(F);let z=e=>{let{data:t,from:n,to:r,selectedTrade:a}=e;if(!t||!t.length)return null;function l(){return(0,o.jsx)(s.xu,{className:Z().divider,sx:{display:"flex",alignItems:"center",justifyContent:"center",flex:1,position:"relative",borderBottom:"1px dashed",borderColor:"gray.4"},children:(0,o.jsx)(H.J,{name:"arrowRightFilled",style:{position:"absolute",top:"-8px",left:"50%",transform:"translateX(-50%)"}})})}let m=(0,L.ln)(a,t);return(0,o.jsxs)(s.xu,{bg:"transparent",width:"100%",mt:"8px",children:[(0,o.jsxs)(i.U,{children:[(0,o.jsx)(d.x,{fontWeight:400,fontSize:"14px",color:"whiteOpacity.70",children:"Trade routing"}),(0,o.jsx)(E.h,{color:"neutral.300",w:"14px",h:"14px"})]}),(0,o.jsxs)(U.r,{mt:4,gridTemplateColumns:"64px 1fr 64px",alignItems:"center",children:[(0,o.jsx)(u.g,{justifyContent:"center",alignItems:"center",height:"64px",className:(0,R.Z)({[Z().fromIcon]:(null==t?void 0:t.length)&&t.length>1}),children:(0,o.jsx)(P.T,{symbol:n.token.symbol,iconUrl:n.token.logoUri,width:"32px",height:"32px"})}),(0,o.jsx)(u.g,{alignItems:"space-around",gap:"24px",children:m&&(0,o.jsxs)(i.U,{justifyContent:"space-around",gap:"8px",minHeight:"40px",className:(0,R.Z)(Z().trade,{[Z().selected]:a&&a===m}),children:[m.route.path.filter((e,t)=>0!==t&&t!==m.route.path.length-1).map(e=>{var t;return(0,o.jsxs)(c.Fragment,{children:[l(),(0,o.jsxs)(i.U,{sx:{padding:"8px",borderRadius:"10px",background:"neutral.1000"},children:[(0,o.jsx)(P.T,{symbol:e.symbol},e.address),(0,o.jsx)(d.x,{children:null!==(t=e.name)&&void 0!==t?t:e.symbol})]})]},e.address)}),l()]})}),(0,o.jsx)(u.g,{justifyContent:"center",height:"64px",className:(0,R.Z)({[Z().toIcon]:(null==t?void 0:t.length)&&t.length>1}),children:(0,o.jsx)(P.T,{symbol:r.token.symbol,iconUrl:r.token.logoUri,width:"32px",height:"32px"})})]})]})};var M=n(78884);let V=e=>{let{rate:t,isLoadingSwapOut:n,state:r,swapOut:a,showInfo:c,trades:u,setSelectedTrade:m}=e,[x,p]=(0,O.Z)(!1),f=(0,L.ln)(r.selectedTrade,u),h=null==f?void 0:f.priceImpact.toFixed();function v(e,t,n){return(0,o.jsxs)(i.U,{justifyContent:"space-between",mb:2,children:[(0,o.jsx)(d.x,{fontWeight:400,fontSize:"14px",color:"whiteOpacity.70",children:e}),n?(0,o.jsx)(W.O,{height:"16px",width:"64px",startColor:"neutral.700",endColor:"neutral.800",mb:"2px"}):(0,o.jsx)(d.x,{fontWeight:400,fontSize:"14px",color:"white",children:t})]})}return n?(0,o.jsx)(s.xu,{bg:"transparent",width:"100%",p:2,mt:"8px",children:(0,o.jsxs)(i.U,{w:"100%",justify:"space-between",children:[(0,o.jsx)(d.x,{color:"neutral.300",children:"Processing..."}),(0,o.jsx)(l.$,{width:5,height:5,color:"orange"})]})}):+r.from.amount>0&&t?(0,o.jsxs)(s.xu,{bg:"transparent",width:"100%",p:2,mt:"8px",children:[(0,o.jsxs)(i.U,{justifyContent:"space-between",children:[(0,o.jsxs)(i.U,{children:[(0,o.jsx)(E.h,{color:"neutral.300",w:"14px",h:"14px"}),(0,o.jsxs)(d.x,{color:"neutral.300",children:["1 ",r.from.token.symbol," = ",Number(t)," ",r.to.token.symbol]})]}),c&&(0,o.jsx)(I.h,{fontSize:16,onClick:p,"aria-label":"Search database",icon:x?(0,o.jsx)(A.g,{}):(0,o.jsx)(N.v,{})})]}),x&&(0,o.jsxs)(s.xu,{mt:4,borderTop:"1px solid gray.500",children:[v("".concat(r.from.token.symbol," / ").concat(r.to.token.symbol," rate"),"1 ".concat(r.from.token.symbol," -> ").concat(t," ").concat(r.to.token.symbol)),v("Minimum received",a),v("Price impact","".concat(h?"".concat((0,M.sm)(+h,2),"%"):"n/a")),(0,o.jsx)(z,{data:u,from:r.from,to:r.to,setSelectedTrade:m,selectedTrade:r.selectedTrade})]})]}):null};var q=n(74153),D=n(7405),_=n(92798);let B=e=>{let{isBalanceExceeded:t,rate:n,amount:r,isLoading:a}=e,l=(0,c.useMemo)(()=>t?"Available balance exceeded":!n&&Number(r)>0&&!a?"Swap is not available due to low input amount":null,[t,n,r,a]);return l?(0,o.jsxs)(q.b,{status:"error",display:"flex",border:"1px solid",borderColor:"danger.800",mt:"16px",borderRadius:"10px",py:"10px",px:"12px",children:[(0,o.jsx)(D.z,{w:"16px",h:"16px",mr:"8px",color:"orange"}),(0,o.jsx)(_.X,{color:"danger.200",children:l})]}):null};var Y=n(82585),J=n(60939),X=n(8328),$=n(66850),G=n(92262),K=n(98260),Q=n(34178),ee=n(103),et=n(48353),en=n(67559),eo=n(53225),er=n(95479),ea=n(91738);let el=e=>{var t,n;let{initialTokensData:r,...a}=e,[l,i]=(0,c.useState)(null),{state:d,handleFromTokenChange:v,handleFromTokenSelect:g,handleToTokenSelect:j,handleFlip:w,swapOut:y,isLoadingSwapOut:E,rate:A,isSwapAvailable:N,isSwapAvailabilityLoading:W,fetchRates:I,resetStateValues:O,pairAddress:U,setSelectedTrade:R,trades:H}=function(e){let[t,n]=(0,c.useState)({from:{token:e.from,amount:""},to:{token:e.to,amount:""},selectedTrade:void 0}),{trades:o,refetch:r}=(0,X.lZ)(t.from,t.to),a=(0,c.useCallback)(()=>{n(e=>({...e,from:{...e.from,amount:""},to:{...e.to,amount:""}})),r()},[r]),l=(0,c.useCallback)(e=>{n(t=>({...t,from:{...t.from,amount:(0,$.Z)(e)}}))},[]),s=(0,c.useCallback)(e=>{n(t=>({...t,from:{...t.from,token:e},to:e.contractAddress.toLowerCase()===t.to.token.contractAddress.toLowerCase()?{...t.from}:{...t.to}}))},[]),i=(0,c.useCallback)(e=>{n(t=>({...t,to:{...t.to,token:e},from:e.contractAddress.toLowerCase()===t.from.token.contractAddress.toLowerCase()?{...t.to,amount:t.from.amount}:{...t.from}}))},[]),d=(0,c.useCallback)(()=>{n(e=>({...e,from:{...e.to,amount:e.from.amount},to:{...e.from,amount:""}}))},[]),u=(0,c.useCallback)(e=>{n(t=>({...t,selectedTrade:e}))},[]),{isSwapAvailable:m,isLoading:x,pairAddress:p}=(0,J.W)(t.from.token,t.to.token,o),{data:f,isLoading:h,refetch:v}=(0,L.SM)({from:t.from.token,to:t.to.token,amount:t.from.amount,isSwapAvailable:m,trades:o,selectedTrade:t.selectedTrade},{refetchInterval:1e4}),{swapOut:g,rate:b}=null!=f?f:{};return{trades:o,state:t,setState:n,handleFromTokenChange:l,handleFromTokenSelect:s,handleToTokenSelect:i,handleFlip:d,swapOut:g,isLoadingSwapOut:h,rate:b,isSwapAvailable:m,isSwapAvailabilityLoading:x,fetchRates:v,resetStateValues:a,pairAddress:p,setSelectedTrade:u}}(r),{swapTokens:P,loading:F}=function(e,t,n,o){let r=(0,k.ZR)(),a=(0,m.SFn)(),{contract:l}=(0,m.cqn)(null==r?void 0:r.CONTRACTS.ROUTER,et),{contract:s}=(0,m.cqn)(null==r?void 0:r.CONTRACTS.WETH,en),i=(0,m.eC)(),{mutate:d}=(0,m.Jfh)(l),[{loading:c,error:u},x]=(0,ee.Z)(async()=>{if(!e.amount||!t||!l||!a||!s)return;let d=await (0,eo.E)();if(e.token.contractAddress===T.aW&&t.token.contractAddress===(null==r?void 0:r.CONTRACTS.WETH))switch(r.modeEnv){case er.jQ.MAINNET:return null==i?void 0:i.wallet.transfer(null==r?void 0:r.CONTRACTS.WETH,+e.amount);case er.jQ.TESTNET:default:return s.call("deposit",[],{value:(0,M.IW)(+e.amount,e.token.decimals)})}else if(e.token.contractAddress===(null==r?void 0:r.CONTRACTS.WETH)&&t.token.contractAddress===T.aW)return s.call("withdraw",[(0,M.IW)(+e.amount,e.token.decimals)]);else if(o&&n){let e=(0,M.$c)(d.slippage/100),r=Q.F0.swapCallParameters(o,{allowedSlippage:new K.gG(e[0],e[1]),ttl:60*d.deadline,recipient:a,feeOnTransfer:!0}),s=[...r.args.slice(0,r.args.length-1),a,r.args.pop()];return"swapExactETHForTokensSupportingFeeOnTransferTokens"===r.methodName?s[0]=(0,M.IW)(+n-d.slippage/100*+n,t.token.decimals):s[1]=(0,M.IW)(+n-d.slippage/100*+n,t.token.decimals),l.call(r.methodName,s,{value:r.value})}},[l,e,t,n,s,o,r]);return{swapTokens:x,loading:c,error:u}}(d.from,d.to,y,(0,L.ln)(d.selectedTrade,H)),{data:Z}=(0,ea.m)(null!==(n=null===(t=d.from.token)||void 0===t?void 0:t.contractAddress)&&void 0!==n?n:""),z=Z&&+Z.displayValue<+d.from.amount;return(0,o.jsx)(s.xu,{padding:"12px",bg:"gray.2",borderRadius:16,maxWidth:"573px",mx:"auto",w:"100%",...a,children:(0,o.jsxs)(u.g,{children:[(0,o.jsx)(f.q,{onRefresh:I}),(0,o.jsx)(Y.r,{label:"You pay",showMax:!0,source:"from",values:d.from,onChange:v,disabled:!1,onTokenSelect:g,filterByPools:!0}),(0,o.jsx)(S.L,{onClick:w}),(0,o.jsx)(Y.r,{label:"You receive",values:d.to,source:"to",disabled:!1,onTokenSelect:j,readOnlyValue:null!=y?y:"",filterByPools:!0}),(0,o.jsx)(h.p,{useThreshold:d.from.token.contractAddress===T.aW,amount:d.from.amount,balance:(null==Z?void 0:Z.displayValue)?Number(Z.displayValue):void 0,onUpdate:v}),(0,o.jsx)(V,{isSwapAvailable:N,isSwapAvailabilityLoading:W,isLoadingSwapOut:E,swapOut:y,state:d,rate:A,showInfo:!0,pairAddress:U,trades:H,setSelectedTrade:R}),(0,o.jsx)(p.q,{}),(0,o.jsx)(C,{state:d,isBalanceExceeded:z,isSwapAvailable:N,swapInProgress:F,onSubmit:async()=>{var e,t,n,r,a;try{let r=await P();if(void 0!==r.reason)(0,b.Eo)(r.reason);else if(r instanceof Error)(0,b.Eo)(r.message);else{O();let a=null==r?void 0:null===(e=r.receipt)||void 0===e?void 0:e.transactionHash;(0,b.XA)("Successfully swaped ".concat(null===(t=d.from.token)||void 0===t?void 0:t.symbol," to ").concat(null===(n=d.to.token)||void 0===n?void 0:n.symbol),(0,o.jsx)(x.d,{txHash:a})),i({status:"success",title:"Transaction Confirmed",message:"Your transaction has been successfully completed",txHash:a})}}catch(e){e instanceof m.qwg?(0,b.Eo)(e.reason):(0,b.Eo)("Error swap ".concat(null===(r=d.from.token)||void 0===r?void 0:r.symbol," to ").concat(null===(a=d.to.token)||void 0===a?void 0:a.symbol)),i({status:"error",title:"Transaction Error",message:"There was an error processing your transaction. Please check the details and try again"})}},isFromValueEmpty:!d.from.amount||0===Number(d.from.amount)}),(0,o.jsx)(B,{amount:d.from.amount,isBalanceExceeded:z,rate:A,isLoading:E}),(0,o.jsx)(G.J,{isOpen:!!l,status:null==l?void 0:l.status,title:null==l?void 0:l.title,message:null==l?void 0:l.message,txHash:null==l?void 0:l.txHash,onClose:()=>i(null)})]})})};var es=n(34392),ei=n(14225),ed=e=>{let{view:t,onChangeView:n,views:r}=e;return(0,o.jsx)(i.U,{w:["100%","fit-content"],alignItems:"flex-start",gap:"3px",px:"8px",py:"8px",sx:{background:"neutral.1000",border:"1px solid",borderColor:"neutral.700",borderRadius:"6px"},children:r.map(e=>(0,o.jsx)(ei.z,{variant:"tertiary",onClick:()=>{n(e.value)},sx:{padding:"12px 24px",color:t===e.value?"orange":"gray.4",bg:t===e.value?"gray.2":"transparent"},size:"md",children:e.label},e.value))})},ec=n(42626),eu=n(2266),em=n(81609);let ex=[{label:"V4",value:"v3"},{label:"V2",value:"v2"}],ep=()=>{let[e,t]=(0,c.useState)("v3"),n=(0,k.ZR)(),u=(0,es.B)(n),m=(0,c.useMemo)(()=>{let e=u.find(e=>e.contractAddress===(null==n?void 0:n.CONTENT.defaultTokens.from)),t=u.find(e=>e.contractAddress===(null==n?void 0:n.CONTENT.defaultTokens.to));return{from:{...e},to:{...t}}},[u,null==n?void 0:n.CONTENT.defaultTokens.from,null==n?void 0:n.CONTENT.defaultTokens.to]);return(0,o.jsxs)(em.Z,{children:[(0,o.jsx)(eu.Z,{title:"Swap | Kim"}),(0,o.jsxs)(s.xu,{padding:[0,"12px"],mt:[4,32],maxWidth:"573px",mx:"auto",w:"100%",children:[(0,o.jsxs)(i.U,{mb:3,justifyContent:"space-between",flexWrap:"wrap",children:[(0,o.jsx)(d.x,{fontSize:[24,32],fontWeight:500,lineHeight:"32px",color:"white",textAlign:"left",children:"Swap"}),(0,o.jsx)(ed,{view:e,onChangeView:e=>t(e),views:ex})]}),m?"v3"===e?(0,o.jsx)(ec.u,{initialTokensData:m}):(0,o.jsx)(el,{initialTokensData:m}):(0,o.jsx)(r.k,{w:"100%",h:"100%",minHeight:"calc(100vh - 200px)",justifyContent:"center",children:(0,o.jsx)(a.M,{children:(0,o.jsx)(l.$,{color:"orange",width:8,height:8})})})]})]})};var ef=ep},50085:function(e,t,n){n.d(t,{W:function(){return o}});var o=(0,n(24027).I)({viewBox:"0 0 16 16",d:"M11.891 9.992a1 1 0 1 1 1.416 1.415l-4.3 4.3a1 1 0 0 1-1.414 0l-4.3-4.3A1 1 0 0 1 4.71 9.992l3.59 3.591 3.591-3.591zm0-3.984L8.3 2.417 4.709 6.008a1 1 0 0 1-1.416-1.415l4.3-4.3a1 1 0 0 1 1.414 0l4.3 4.3a1 1 0 1 1-1.416 1.415z",displayName:"ArrowUpDownIcon"})}}]);
//# sourceMappingURL=3854-d7acde7d1a59b615.js.map